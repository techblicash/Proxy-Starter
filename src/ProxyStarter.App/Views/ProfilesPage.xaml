<Page x:Class="ProxyStarter.App.Views.ProfilesPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
      xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
      xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
      mc:Ignorable="d">
    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="16">
            <TextBlock Text="{DynamicResource Text_Profiles}"
                       FontSize="28"
                       FontWeight="SemiBold"
                       Margin="0,0,0,16" />

            <ui:Card Padding="16">
                <StackPanel>
                    <WrapPanel Margin="0,0,0,12">
                        <ui:Button Content="{DynamicResource Text_Add}" Command="{Binding AddProfileCommand}" Margin="0,0,8,0" />
                        <ui:Button Content="{DynamicResource Text_Update}" Command="{Binding UpdateSelectedCommand}" Margin="0,0,8,0" />
                        <ui:Button Content="{DynamicResource Text_Refresh}" Command="{Binding RefreshAllCommand}" Margin="0,0,8,0" />
                        <ui:Button Content="{DynamicResource Text_Edit}" Command="{Binding EditSelectedCommand}" Margin="0,0,8,0" />
                        <ui:Button Content="{DynamicResource Text_EditFile}" Command="{Binding EditFileSelectedCommand}" Margin="0,0,8,0" />
                        <ui:Button Content="{DynamicResource Text_Save}" Command="{Binding SaveProfilesCommand}" Margin="0,0,8,0" />
                        <ui:Button Content="{DynamicResource Text_Remove}" Command="{Binding RemoveSelectedCommand}" />
                    </WrapPanel>

                    <DataGrid ItemsSource="{Binding Profiles}"
                              SelectedItem="{Binding SelectedProfile, Mode=TwoWay}"
                              AutoGenerateColumns="False"
                              IsReadOnly="False"
                              CanUserAddRows="False"
                              SelectionMode="Single"
                              SelectionUnit="FullRow"
                              HeadersVisibility="Column"
                              RowEditEnding="OnRowEditEnding"
                              MouseDoubleClick="OnGridMouseDoubleClick"
                              MinHeight="260">
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow"
                                   BasedOn="{StaticResource {x:Type DataGridRow}}">
                                <Setter Property="Background" Value="Transparent" />
                                <Setter Property="BorderBrush" Value="Transparent" />
                                <Setter Property="BorderThickness" Value="1" />
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="{DynamicResource ControlFillColorSecondaryBrush}" />
                                    </Trigger>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="{DynamicResource AccentFillColorSecondaryBrush}" />
                                        <Setter Property="BorderBrush" Value="{DynamicResource AccentFillColorDefaultBrush}" />
                                    </Trigger>
                                    <DataTrigger Binding="{Binding IsActive}" Value="True">
                                        <Setter Property="Background" Value="{DynamicResource AccentFillColorSecondaryBrush}" />
                                        <Setter Property="BorderBrush" Value="{DynamicResource AccentFillColorDefaultBrush}" />
                                    </DataTrigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="{DynamicResource Text_Name}" Binding="{Binding Name}" Width="*" />
                            <DataGridTextColumn Header="{DynamicResource Text_URL}" Binding="{Binding Url}" Width="2*" />
                            <DataGridTextColumn Header="{DynamicResource Text_Nodes}" Binding="{Binding NodeCount}" Width="100" />
                            <DataGridCheckBoxColumn Header="{DynamicResource Text_Enabled}" Binding="{Binding IsEnabled}" Width="100" />
                            <DataGridCheckBoxColumn Header="{DynamicResource Text_AutoUpdate}" Binding="{Binding AutoUpdateEnabled}" Width="120" />
                            <DataGridTextColumn Header="{DynamicResource Text_IntervalMinutes}" Binding="{Binding AutoUpdateIntervalMinutes}" Width="120" />
                            <DataGridTextColumn Header="{DynamicResource Text_LastUpdated}" Binding="{Binding LastUpdated}" Width="160" />
                        </DataGrid.Columns>
                    </DataGrid>
                </StackPanel>
            </ui:Card>
        </StackPanel>
    </ScrollViewer>
</Page>
