<ui:FluentWindow x:Class="ProxyStarter.App.Views.TrayMenuWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
                 xmlns:models="clr-namespace:ProxyStarter.App.Models"
                 mc:Ignorable="d"
                 Width="300"
                 Height="420"
                 WindowStyle="None"
                 ResizeMode="NoResize"
                 ShowInTaskbar="False"
                 WindowBackdropType="Acrylic"
                 WindowCornerPreference="Round"
                 ExtendsContentIntoTitleBar="True"
                 Background="Transparent"
                 UseLayoutRounding="True"
                 SnapsToDevicePixels="True"
                 TextOptions.TextFormattingMode="Display"
                 TextOptions.TextRenderingMode="ClearType"
                 TextOptions.TextHintingMode="Fixed"
                 FontFamily="Segoe UI Variable">
    <Border Margin="8"
            Padding="10"
            CornerRadius="14"
            Background="{DynamicResource LayerOnAcrylicFillColorDefaultBrush}"
            BorderBrush="{DynamicResource SurfaceStrokeColorFlyoutBrush}"
            BorderThickness="1"
            SnapsToDevicePixels="True">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="Auto" />
                <RowDefinition Height="*" />
            </Grid.RowDefinitions>

            <TextBlock Text="{DynamicResource Text_AppName}"
                       FontWeight="SemiBold"
                       Margin="6,2,6,8"
                       Foreground="{DynamicResource TextFillColorPrimaryBrush}" />

            <Border Grid.Row="1"
                    Height="1"
                    Margin="0,0,0,10"
                    Background="{DynamicResource DividerStrokeColorDefaultBrush}"
                    Opacity="0.8" />

            <StackPanel Grid.Row="2">
                <ui:Button Content="{DynamicResource Text_Open}"
                           Click="OnOpenClicked"
                           Appearance="Transparent"
                           HorizontalContentAlignment="Left"
                           Padding="10,6"
                           Height="36"
                           HorizontalAlignment="Stretch"
                           Margin="0,0,0,6" />
                <ui:Button Content="{Binding CoreToggleLabel}"
                           Click="OnToggleCoreClicked"
                           Appearance="Transparent"
                           HorizontalContentAlignment="Left"
                           Padding="10,6"
                           Height="36"
                           HorizontalAlignment="Stretch"
                           Margin="0,0,0,6" />
                <ui:Button Content="{DynamicResource Text_Exit}"
                           Click="OnExitClicked"
                           Appearance="Transparent"
                           HorizontalContentAlignment="Left"
                           Padding="10,6"
                           Height="36"
                           HorizontalAlignment="Stretch" />

                <Border Height="1"
                        Margin="0,12,0,12"
                        Background="{DynamicResource DividerStrokeColorDefaultBrush}"
                        Opacity="0.8" />

                <TextBlock Text="{DynamicResource Text_Node}"
                           FontWeight="SemiBold"
                           Margin="6,0,6,8"
                           Foreground="{DynamicResource TextFillColorPrimaryBrush}" />

                <ui:TextBox x:Name="NodeSearchBox"
                            Height="32"
                            Margin="0,0,0,8"
                            VerticalContentAlignment="Center"
                            PlaceholderText="{DynamicResource Text_SearchPlaceholder}"
                            TextChanged="OnNodeSearchTextChanged" />

                <Border Background="{DynamicResource LayerOnAcrylicFillColorDefaultBrush}"
                        BorderBrush="{DynamicResource SurfaceStrokeColorDefaultBrush}"
                        BorderThickness="1"
                        CornerRadius="10"
                        Padding="4">
                    <ui:ListView x:Name="NodesList"
                                 Height="190"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 ScrollViewer.HorizontalScrollBarVisibility="Disabled"
                                 VirtualizingPanel.IsVirtualizing="True"
                                 VirtualizingPanel.VirtualizationMode="Recycling"
                                 VirtualizingStackPanel.ScrollUnit="Pixel"
                                 SelectionChanged="OnNodeSelectionChanged">
                        <ui:ListView.ItemTemplate>
                            <DataTemplate DataType="{x:Type models:ProxyNode}">
                                <Grid Margin="6,4">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <TextBlock Text="{Binding Name}"
                                               TextTrimming="CharacterEllipsis" />

                                    <ui:SymbolIcon x:Name="ActiveIcon"
                                                   Grid.Column="1"
                                                   Symbol="Checkmark24"
                                                   Margin="8,0,0,0"
                                                   Foreground="{DynamicResource AccentFillColorDefaultBrush}"
                                                   Visibility="Collapsed" />
                                </Grid>
                                <DataTemplate.Triggers>
                                    <DataTrigger Binding="{Binding IsActive}" Value="True">
                                        <Setter TargetName="ActiveIcon" Property="Visibility" Value="Visible" />
                                    </DataTrigger>
                                </DataTemplate.Triggers>
                            </DataTemplate>
                        </ui:ListView.ItemTemplate>
                    </ui:ListView>
                </Border>

                <TextBlock x:Name="NodesStatusText"
                           Margin="6,8,6,0"
                           Opacity="0.7"
                           TextWrapping="Wrap" />
            </StackPanel>
        </Grid>
    </Border>
</ui:FluentWindow>
